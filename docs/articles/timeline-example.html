<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="appc">
<title>Timeline Example • appc</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Timeline Example">
<meta property="og:description" content="appc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">appc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/case-crossover-example.html">Case-Crossover Example</a>
    <a class="dropdown-item" href="../articles/cv-model-performance.html">CV Model Performance</a>
    <a class="dropdown-item" href="../articles/timeline-example.html">Timeline Example</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/geomarker-io/appc/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Timeline Example</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/geomarker-io/appc/blob/HEAD/vignettes/articles/timeline-example.Rmd" class="external-link"><code>vignettes/articles/timeline-example.Rmd</code></a></small>
      <div class="d-none name"><code>timeline-example.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/geomarker-io/appc" class="external-link">appc</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>This example details how to use the appc package to add air pollution
exposure estimates for exact locations and time periods defined by
geocoded coordinates and a “key” date. For this example workflow, we
will simulate 20 random locations in Wayne County, Michigan and dates of
birth during 2022, but in actuality this can be any set of geocoded
<code>lat</code> and <code>lon</code> columns with corresponding
dates.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">tigris</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tigris/man/counties.html" class="external-link">counties</a></span><span class="op">(</span><span class="st">"MI"</span>, year <span class="op">=</span> <span class="fl">2021</span>, progress_bar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">GEOID</span> <span class="op">==</span> <span class="fl">26163</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_sample.html" class="external-link">st_sample</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>lat <span class="op">=</span> <span class="va">Y</span>, lon <span class="op">=</span> <span class="va">X</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>dob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2023-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2023-12-31"</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 3</span></span></span>
<span><span class="co">#&gt;      lon   lat dob       </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> -<span style="color: #BB0000;">83.5</span>  42.3 2023-10-31</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">82.9</span>  42.4 2023-11-27</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">83.4</span>  42.1 2023-10-18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">83.2</span>  42.2 2023-05-10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">83.2</span>  42.3 2023-12-09</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">83.3</span>  42.3 2023-05-11</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">82.9</span>  42.4 2023-10-21</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">83.3</span>  42.2 2023-08-22</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">83.2</span>  42.2 2023-03-06</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">83.4</span>  42.2 2023-08-19</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> -<span style="color: #BB0000;">83.2</span>  42.1 2023-05-30</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> -<span style="color: #BB0000;">83.5</span>  42.3 2023-05-27</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> -<span style="color: #BB0000;">83.2</span>  42.2 2023-09-15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> -<span style="color: #BB0000;">83.3</span>  42.1 2023-11-16</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> -<span style="color: #BB0000;">83.4</span>  42.2 2023-02-09</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> -<span style="color: #BB0000;">83.5</span>  42.3 2023-07-12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> -<span style="color: #BB0000;">83.5</span>  42.4 2023-06-05</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> -<span style="color: #BB0000;">83.4</span>  42.3 2023-01-12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> -<span style="color: #BB0000;">83.3</span>  42.3 2023-10-24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> -<span style="color: #BB0000;">83.2</span>  42.2 2023-02-11</span></span></code></pre></div>
<p>For this example, we want to estimate the average fine particulate
matter from 90 days prior to birth until the date of birth. Using the
dob column as the start date, we will define an end date in our example
data and also define the s2 cell identifers based on the latitude and
longitude coordinates.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">d</span>, dob_plus_90 <span class="op">=</span> <span class="va">dob</span> <span class="op">+</span> <span class="fl">90</span>,</span>
<span>           s2 <span class="op">=</span> <span class="fu">s2</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/s2/reference/s2_cell.html" class="external-link">as_s2_cell</a></span><span class="op">(</span><span class="fu">s2</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/s2/reference/s2_geog_point.html" class="external-link">s2_geog_point</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;     lon   lat dob        dob_plus_90 s2              </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;s2cell&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">83.5</span>  42.3 2023-10-31 2024-01-29  883b539fde6f468f</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> -<span style="color: #BB0000;">82.9</span>  42.4 2023-11-27 2024-02-25  882529be4afb184b</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">83.4</span>  42.1 2023-10-18 2024-01-16  883b5cadcae041d3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> -<span style="color: #BB0000;">83.2</span>  42.2 2023-05-10 2023-08-08  883b36dae69ea671</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> -<span style="color: #BB0000;">83.2</span>  42.3 2023-12-09 2024-03-08  883b339ae99f458f</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> -<span style="color: #BB0000;">83.3</span>  42.3 2023-05-11 2023-08-09  883b4b9750a4f19d</span></span></code></pre></div>
<p>Next, use the newly created columns to call the
<code><a href="../reference/predict_pm25_date_range.html">predict_pm25_date_range()</a></code> function, which is a simpler
implementation of predict_pm25 that takes vectors of start and end dates
instead of lists of date vectors for each s2 cell location:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">d</span>, pm25 <span class="op">=</span> <span class="fu"><a href="../reference/predict_pm25_date_range.html">predict_pm25_date_range</a></span><span class="op">(</span><span class="va">s2</span>, <span class="va">dob</span>, <span class="va">dob_plus_90</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> (down)loading random forest model</span></span>
<span><span class="co">#&gt; loaded rf_pm_v1 in 13s</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> (down)loading random forest model <span style="color: #B2B2B2;">[13.2s]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> checking that s2 are within the contiguous US</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> checking that s2 are within the contiguous US <span style="color: #B2B2B2;">[59ms]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> adding coordinates</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> adding coordinates <span style="color: #B2B2B2;">[26ms]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> adding elevation</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> adding elevation <span style="color: #B2B2B2;">[1.9s]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> adding HMS smoke data</span></span>
<span><span class="co">#&gt; intersecting smoke data <span style="color: #00BB00;">■■■■■■■                         </span>  20% |  ETA:  4s</span></span>
<span><span class="co">#&gt; intersecting smoke data <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■             </span>  60% |  ETA:  3s</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> adding HMS smoke data<span style="color: #00BB00;">✔</span> adding HMS smoke data <span style="color: #B2B2B2;">[7.9s]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> adding NARR</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> adding NARR <span style="color: #B2B2B2;">[958ms]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> adding gridMET</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> adding gridMET <span style="color: #B2B2B2;">[895ms]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> adding MERRA</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> adding MERRA <span style="color: #B2B2B2;">[20.6s]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> adding time components</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> adding time components <span style="color: #B2B2B2;">[115ms]</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 6</span></span></span>
<span><span class="co">#&gt;      lon   lat dob        dob_plus_90 s2               pm25             </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;s2cell&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> -<span style="color: #BB0000;">83.5</span>  42.3 2023-10-31 2024-01-29  883b539fde6f468f <span style="color: #949494;">&lt;tibble [91 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">82.9</span>  42.4 2023-11-27 2024-02-25  882529be4afb184b <span style="color: #949494;">&lt;tibble [91 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">83.4</span>  42.1 2023-10-18 2024-01-16  883b5cadcae041d3 <span style="color: #949494;">&lt;tibble [91 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">83.2</span>  42.2 2023-05-10 2023-08-08  883b36dae69ea671 <span style="color: #949494;">&lt;tibble [91 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">83.2</span>  42.3 2023-12-09 2024-03-08  883b339ae99f458f <span style="color: #949494;">&lt;tibble [91 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">83.3</span>  42.3 2023-05-11 2023-08-09  883b4b9750a4f19d <span style="color: #949494;">&lt;tibble [91 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">82.9</span>  42.4 2023-10-21 2024-01-19  8824d53e3f2addd3 <span style="color: #949494;">&lt;tibble [91 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">83.3</span>  42.2 2023-08-22 2023-11-20  883b462c96efefa9 <span style="color: #949494;">&lt;tibble [91 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">83.2</span>  42.2 2023-03-06 2023-06-04  883b37c7f61125bf <span style="color: #949494;">&lt;tibble [91 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">83.4</span>  42.2 2023-08-19 2023-11-17  883b44e161d94b5d <span style="color: #949494;">&lt;tibble [91 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> -<span style="color: #BB0000;">83.2</span>  42.1 2023-05-30 2023-08-28  883b3f38bc72bc79 <span style="color: #949494;">&lt;tibble [91 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> -<span style="color: #BB0000;">83.5</span>  42.3 2023-05-27 2023-08-25  883b5129692a69f7 <span style="color: #949494;">&lt;tibble [91 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> -<span style="color: #BB0000;">83.2</span>  42.2 2023-09-15 2023-12-14  883b362d7f446e2d <span style="color: #949494;">&lt;tibble [91 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> -<span style="color: #BB0000;">83.3</span>  42.1 2023-11-16 2024-02-14  883b41493a95f44f <span style="color: #949494;">&lt;tibble [91 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> -<span style="color: #BB0000;">83.4</span>  42.2 2023-02-09 2023-05-10  883b451132452249 <span style="color: #949494;">&lt;tibble [91 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> -<span style="color: #BB0000;">83.5</span>  42.3 2023-07-12 2023-10-10  883b56ca718e3a5b <span style="color: #949494;">&lt;tibble [91 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> -<span style="color: #BB0000;">83.5</span>  42.4 2023-06-05 2023-09-03  8824abeaf2f4640b <span style="color: #949494;">&lt;tibble [91 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> -<span style="color: #BB0000;">83.4</span>  42.3 2023-01-12 2023-04-12  883b4ef3cd3ded53 <span style="color: #949494;">&lt;tibble [91 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> -<span style="color: #BB0000;">83.3</span>  42.3 2023-10-24 2024-01-22  883b496b4a4bf401 <span style="color: #949494;">&lt;tibble [91 × 2]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> -<span style="color: #BB0000;">83.2</span>  42.2 2023-02-11 2023-05-12  883b3733a728db21 <span style="color: #949494;">&lt;tibble [91 × 2]&gt;</span></span></span></code></pre></div>
<p>If interested in average exposures (and their uncertainties) from
start date to end date (instead of daily exposures), we can extract
those directly:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_pm25</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">d</span>, <span class="fu"><a href="../reference/predict_pm25_date_range.html">predict_pm25_date_range</a></span><span class="op">(</span><span class="va">s2</span>, <span class="va">dob</span>, <span class="va">dob_plus_90</span>, average <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> (down)loading random forest model</span></span>
<span><span class="co">#&gt; loaded rf_pm_v1 in 0s</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> (down)loading random forest model <span style="color: #B2B2B2;">[21ms]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> checking that s2 are within the contiguous US</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> checking that s2 are within the contiguous US <span style="color: #B2B2B2;">[81ms]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> adding coordinates</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> adding coordinates <span style="color: #B2B2B2;">[66ms]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> adding elevation</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> adding elevation <span style="color: #B2B2B2;">[632ms]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> adding HMS smoke data</span></span>
<span><span class="co">#&gt; intersecting smoke data <span style="color: #00BB00;">■■■■■                           </span>  15% |  ETA: 12s</span></span>
<span><span class="co">#&gt; intersecting smoke data <span style="color: #00BB00;">■■■■■■■■■■                      </span>  30% |  ETA: 11s</span></span>
<span><span class="co">#&gt; intersecting smoke data <span style="color: #00BB00;">■■■■■■■■■■■■■■■■                </span>  50% |  ETA:  8s</span></span>
<span><span class="co">#&gt; intersecting smoke data <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■             </span>  60% |  ETA:  7s</span></span>
<span><span class="co">#&gt; intersecting smoke data <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■         </span>  75% |  ETA:  5s</span></span>
<span><span class="co">#&gt; intersecting smoke data <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■     </span>  85% |  ETA:  3s</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> adding HMS smoke data<span style="color: #00BB00;">✔</span> adding HMS smoke data <span style="color: #B2B2B2;">[24s]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> adding NARR</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> adding NARR <span style="color: #B2B2B2;">[2s]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> adding gridMET</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> adding gridMET <span style="color: #B2B2B2;">[2.1s]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> adding MERRA</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> adding MERRA <span style="color: #B2B2B2;">[3.6s]</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> adding time components</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> adding time components <span style="color: #B2B2B2;">[22ms]</span></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span><span class="va">d</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">d_pm25</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 7</span></span></span>
<span><span class="co">#&gt;      lon   lat dob        dob_plus_90 s2                pm25 pm25_se</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;s2cell&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> -<span style="color: #BB0000;">83.5</span>  42.3 2023-10-31 2024-01-29  883b539fde6f468f  9.05   0.165</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">82.9</span>  42.4 2023-11-27 2024-02-25  882529be4afb184b  9.06   0.156</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">83.4</span>  42.1 2023-10-18 2024-01-16  883b5cadcae041d3  8.23   0.146</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">83.2</span>  42.2 2023-05-10 2023-08-08  883b36dae69ea671 15.0    0.369</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">83.2</span>  42.3 2023-12-09 2024-03-08  883b339ae99f458f  9.23   0.177</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">83.3</span>  42.3 2023-05-11 2023-08-09  883b4b9750a4f19d 14.5    0.357</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">82.9</span>  42.4 2023-10-21 2024-01-19  8824d53e3f2addd3  8.48   0.159</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">83.3</span>  42.2 2023-08-22 2023-11-20  883b462c96efefa9  7.04   0.107</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">83.2</span>  42.2 2023-03-06 2023-06-04  883b37c7f61125bf  8.15   0.123</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">83.4</span>  42.2 2023-08-19 2023-11-17  883b44e161d94b5d  7.13   0.116</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> -<span style="color: #BB0000;">83.2</span>  42.1 2023-05-30 2023-08-28  883b3f38bc72bc79 14.8    0.448</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> -<span style="color: #BB0000;">83.5</span>  42.3 2023-05-27 2023-08-25  883b5129692a69f7 14.5    0.327</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> -<span style="color: #BB0000;">83.2</span>  42.2 2023-09-15 2023-12-14  883b362d7f446e2d  7.17   0.121</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> -<span style="color: #BB0000;">83.3</span>  42.1 2023-11-16 2024-02-14  883b41493a95f44f  9.01   0.158</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> -<span style="color: #BB0000;">83.4</span>  42.2 2023-02-09 2023-05-10  883b451132452249  7.26   0.113</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> -<span style="color: #BB0000;">83.5</span>  42.3 2023-07-12 2023-10-10  883b56ca718e3a5b  9.62   0.134</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> -<span style="color: #BB0000;">83.5</span>  42.4 2023-06-05 2023-09-03  8824abeaf2f4640b 14.0    0.386</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> -<span style="color: #BB0000;">83.4</span>  42.3 2023-01-12 2023-04-12  883b4ef3cd3ded53  7.63   0.128</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> -<span style="color: #BB0000;">83.3</span>  42.3 2023-10-24 2024-01-22  883b496b4a4bf401  8.58   0.160</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> -<span style="color: #BB0000;">83.2</span>  42.2 2023-02-11 2023-05-12  883b3733a728db21  7.68   0.134</span></span></code></pre></div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cole Brokamp, Erika Manning, Qing Duan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
