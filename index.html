<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Air Pollution Predictor Commons • appc</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Air Pollution Predictor Commons">
<meta name="description" content="Functions for geomarker assessment for s2 locations and dates. These are used to train and predict daily ambient air pollution concentrations across the contiguous US 2016 - 2022.">
<meta property="og:description" content="Functions for geomarker assessment for s2 locations and dates. These are used to train and predict daily ambient air pollution concentrations across the contiguous US 2016 - 2022.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">appc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/case-crossover-example.html">Case-Crossover Example</a></li>
    <li><a class="dropdown-item" href="articles/cv-model-performance.html">CV Model Performance</a></li>
    <li><a class="dropdown-item" href="articles/timeline-example.html">Timeline Example</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/geomarker-io/appc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="air-pollution-prediction-commons">Air Pollution Prediction Commons<a class="anchor" aria-label="anchor" href="#air-pollution-prediction-commons"></a>
</h1></div>
<!-- badges: start -->

<div class="section level2">
<h2 id="about">About<a class="anchor" aria-label="anchor" href="#about"></a>
</h2>
<p>The goal of the appc package is to provide daily, high resolution, near real-time, model-based ambient air pollution exposure assessments. This is achieved by training a generalized random forest on several geomarkers to predict daily average EPA AQS concentrations from 2017 until the present at exact locations across the contiguous United States (see <code><a href="articles/cv-model-performance.html">vignette("cv-model-performance")</a></code> for more details). The appc package contains functions for generating geomarker predictors and the ambient air pollution concentrations. Predictor geomarkers include weather and atmospheric information, wildfire smoke plumes, elevation, and satellite-based aerosol diagnostics products. Source files included with the package train and evaluate models that can be updated with any release to use more recent AQS measurements and/or geomarker predictors.</p>
</div>
<div class="section level2">
<h2 id="installing">Installing<a class="anchor" aria-label="anchor" href="#installing"></a>
</h2>
<p>Install the development version of appc from GitHub with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"geomarker-io/appc"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>In R, create model-based predictions of ambient air pollution concentrations at exact locations on specific dates using the <code><a href="reference/predict_pm25.html">predict_pm25()</a></code> function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">appc</span><span class="fu">::</span><span class="fu"><a href="reference/predict_pm25.html">predict_pm25</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu">s2</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/s2/reference/s2_cell.html" class="external-link">as_s2_cell</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"8841b39a7c46e25f"</span>, <span class="st">"8841a45555555555"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  dates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2023-05-18"</span>, <span class="st">"2023-11-06"</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2023-06-22"</span>, <span class="st">"2023-08-15"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ℹ (down)loading random forest model</span></span>
<span><span class="co">#&gt; ✔ (down)loading random forest model [9.2s]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ checking that s2 are within the contiguous US</span></span>
<span><span class="co">#&gt; ✔ checking that s2 are within the contiguous US [60ms]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ adding coordinates</span></span>
<span><span class="co">#&gt; ✔ adding coordinates [1.6s]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ adding elevation</span></span>
<span><span class="co">#&gt; ✔ adding elevation [1.4s]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ adding HMS smoke data</span></span>
<span><span class="co">#&gt; ✔ adding HMS smoke data [889ms]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ adding NARR</span></span>
<span><span class="co">#&gt; ✔ adding NARR [483ms]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ adding gridMET</span></span>
<span><span class="co">#&gt; ✔ adding gridMET [443ms]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ adding MERRA</span></span>
<span><span class="co">#&gt; ✔ adding MERRA [558ms]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ adding time components</span></span>
<span><span class="co">#&gt; ✔ adding time components [23ms]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 2</span></span>
<span><span class="co">#&gt;    pm25 pm25_se</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1  8.16   1.11 </span></span>
<span><span class="co">#&gt; 2  9.28   0.806</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 2</span></span>
<span><span class="co">#&gt;    pm25 pm25_se</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1  5.13   0.381</span></span>
<span><span class="co">#&gt; 2  5.95   0.466</span></span></code></pre></div>
<p>Installed geomarker data sources and the grf model are hosted as release assets on GitHub and are downloaded locally to the package-specific R user data directory (i.e., <code>tools::R_user_dir("appc", "data")</code>). These files are cached across all of an R user’s sessions and projects. (Specify an alternative download location by setting the <code>R_USER_DATA_DIR</code> environment variable; see <code><a href="https://rdrr.io/r/tools/userdir.html" class="external-link">?tools::R_user_dir</a></code>.)</p>
<p>See more examples in <code><a href="articles/timeline-example.html">vignette("timeline-example")</a></code>.</p>
</div>
<div class="section level2">
<h2 id="s2-geohash">S2 geohash<a class="anchor" aria-label="anchor" href="#s2-geohash"></a>
</h2>
<p>The <a href="https://s2geometry.io/" class="external-link">s2 geohash</a> is a <a href="https://s2geometry.io/devguide/s2cell_hierarchy.html" class="external-link">hierarchical</a> geospatial index that uses <a href="https://s2geometry.io/about/overview" class="external-link">spherical geometry</a>. The appc package uses s2 cells via the <a href="https://r-spatial.github.io/s2/" class="external-link">s2</a> package to specify geospatial locations. In R, s2 cells can be <a href="https://r-spatial.github.io/s2/reference/s2_cell.html#ref-examples" class="external-link">created</a> using their character string representation, or by specifying latitude and longitude coordinates; e.g.:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">s2</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/s2/reference/s2_lnglat.html" class="external-link">s2_lnglat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">84.4126</span>, <span class="op">-</span><span class="fl">84.5036</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">39.1582</span>, <span class="fl">39.2875</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">s2</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/s2/reference/s2_cell.html" class="external-link">as_s2_cell</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;s2_cell[2]&gt;</span></span>
<span><span class="co">#&gt; [1] 8841ad122d9774a7 88404ebdac3ea7d1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="geomarker-assessment">Geomarker Assessment<a class="anchor" aria-label="anchor" href="#geomarker-assessment"></a>
</h2>
<p>Spatiotemporal geomarkers are used for predicting air pollution concentrations, but also serve as exposures or confounding exposures themselves. View information and options about each geomarker:</p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>geomarker</th>
<th>appc function</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>🌦 weather &amp; atmospheric conditions</td>
<td>
<code>get_gridmet_data</code>, <code><a href="reference/get_narr_data.html">get_narr_data()</a></code>
</td>
</tr>
<tr class="even">
<td>🛰 satellite-based aerosol diagnostics</td>
<td><code><a href="reference/get_merra_data.html">get_merra_data()</a></code></td>
</tr>
<tr class="odd">
<td>🔥 wildfire smoke</td>
<td><code><a href="reference/get_hms_smoke_data.html">get_hms_smoke_data()</a></code></td>
</tr>
<tr class="even">
<td>🗻 elevation</td>
<td><code><a href="reference/get_elevation_summary.html">get_elevation_summary()</a></code></td>
</tr>
</tbody>
</table>
<p>Currently, <code>get_urban_imperviousness()</code>, <code>get_traffic()</code>, and <code>get_nei_point_summary()</code> are stashed in the <code>/inst</code> folder and are not integrated into this package.</p>
</div>
<div class="section level2">
<h2 id="developing">Developing<a class="anchor" aria-label="anchor" href="#developing"></a>
</h2>
<blockquote>
<p>Please note that the appc project is released with a <a href="http://geomarker.io/appc/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</blockquote>
<p>To create and release geomarker data for release assets, as well as to create the AQS training data, train, and evaluate a generalized random forest model, use <a href="https://just.systems/man/en/" class="external-link"><code>just</code></a> to execute recipes in the <code>justfile</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="op">&gt;</span> just <span class="ex">--list</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="ex">Available</span> recipes:</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>    <span class="ex">build_site</span>             <span class="co"># build readme and webpage</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>    <span class="ex">check</span>                  <span class="co"># CRAN check package</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>    <span class="ex">dl_geomarker_data</span>      <span class="co"># download all geomarker ahead of time, if not already cached</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>    <span class="ex">docker_test</span>            <span class="co"># run tests without cached release files</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>    <span class="ex">docker_tool</span>            <span class="co"># build docker image preloaded with {appc} and data</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>    <span class="ex">make_training_data</span>     <span class="co"># make training data for GRF</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>    <span class="ex">release_hms_smoke_data</span> <span class="co"># install smoke data from source and upload to github release</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>    <span class="ex">release_merra_data</span>     <span class="co"># upload merra data to github release</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>    <span class="ex">release_model</span>          <span class="co"># upload grf model and training data to current github release</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>    <span class="ex">train_model</span>            <span class="co"># train grf model and render report</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/geomarker-io/appc/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing appc</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Cole Brokamp <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-0289-3151" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Erika Manning <br><small class="roles"> Author </small>  </li>
<li>Qing Duan <br><small class="roles"> Author </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/geomarker-io/appc/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/geomarker-io/appc/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://CRAN.R-project.org/package=appc" class="external-link"><img src="https://www.r-pkg.org/badges/version/appc" alt="CRAN status"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cole Brokamp, Erika Manning, Qing Duan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
